{"version":3,"sources":["../../src/pages/feed/feed.module.ts","../../src/pages/feed/feed.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { FeedPage } from './feed';\r\nimport { ComponentsModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    FeedPage\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(FeedPage),\r\n    ComponentsModule\r\n  ]\r\n})\r\nexport class FeedPageModule {\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/feed/feed.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, MenuController, NavController, NavParams, ToastController } from 'ionic-angular';\r\nimport { PostsProvider } from '../../providers/posts/posts';\r\nimport { AuthHelperProvider } from '../../providers/auth-helper/auth-helper';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-feed',\r\n  templateUrl: 'feed.html'\r\n})\r\nexport class FeedPage {\r\n\r\n  feedPosts: Array<any> = [];\r\n  isInfiniteScrollEnabled = true;\r\n  subscriptions = [];\r\n  isLoggedIn = false;\r\n\r\n  isEmpty = false;\r\n\r\n  constructor(public navCtrl: NavController,\r\n              public navParams: NavParams,\r\n              public menu: MenuController,\r\n              public postsProvider: PostsProvider,\r\n              public toastCtrl: ToastController,\r\n              public authHelperProvider: AuthHelperProvider) {\r\n    this.authHelperProvider.isLoggedIn().then((isLogged) => {\r\n      this.isLoggedIn = isLogged;\r\n    });\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.getInitialPosts();\r\n  }\r\n\r\n  getPosts(infiniteScroll) {\r\n    let lastPostTime = new Date(this.feedPosts[this.feedPosts.length - 1].createdAt).getTime();\r\n    this.postsProvider.getFeedPosts(lastPostTime).subscribe((retrievedPictures) => {\r\n      if (retrievedPictures.success) {\r\n        const picData = retrievedPictures.data;\r\n        this.feedPosts.push(...picData);\r\n        infiniteScroll.complete();\r\n      } else {\r\n        console.log(retrievedPictures);\r\n        this.toastCtrl.create({\r\n          message: 'No more posts available',\r\n          duration: 3000\r\n        }).present();\r\n        infiniteScroll.complete();\r\n        this.isInfiniteScrollEnabled = false;\r\n      }\r\n    }, (error) => {\r\n      console.log(error);\r\n      if (error.status === 404) {\r\n        return this.toastCtrl.create({\r\n          message: 'No more posts available',\r\n          duration: 3000\r\n        }).present();\r\n      }\r\n      this.toastCtrl.create({\r\n        message: 'An error occured when getting posts',\r\n        duration: 3000\r\n      }).present();\r\n      infiniteScroll.complete();\r\n      this.isInfiniteScrollEnabled = false;\r\n    });\r\n  }\r\n\r\n  getInitialPosts(refresher?) {\r\n    this.isInfiniteScrollEnabled = true;\r\n    let time = new Date().getTime();\r\n    this.postsProvider.getFeedPosts(time).subscribe((retrievedPictures) => {\r\n      if (refresher) {\r\n        refresher.complete();\r\n      }\r\n      this.feedPosts = retrievedPictures.data;\r\n    }, (error) => {\r\n      if (refresher) {\r\n        refresher.complete();\r\n      }\r\n      console.log(error);\r\n      if (error.status !== 404) {\r\n        return this.toastCtrl.create({\r\n          message: 'An error occured.',\r\n          duration: 3000\r\n        }).present();\r\n      }\r\n      this.isEmpty = true;\r\n    });\r\n  }\r\n\r\n  selectDiscoverTab() {\r\n    let tabs = this.navCtrl.parent;\r\n    tabs.select(0);\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/feed/feed.ts"],"sourceRoot":""}