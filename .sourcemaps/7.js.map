{"version":3,"sources":["../../src/pages/profile/profile.module.ts","../../src/pages/profile/profile.ts"],"names":[],"mappings":"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","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ProfilePage } from './profile';\r\nimport { ComponentsModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ProfilePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ProfilePage),\r\n    ComponentsModule\r\n  ],\r\n})\r\nexport class ProfilePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ToastController, ViewController, ModalController, Events } from 'ionic-angular';\nimport { ProfileProvider } from '../../providers/profile/profile';\nimport { AuthHelperProvider } from '../../providers/auth-helper/auth-helper';\nimport { PostsProvider } from '../../providers/posts/posts';\nimport { PostProvider } from '../../providers/post/post';\nimport { UsersProvider } from '../../providers/users/users';\nimport { Storage } from '@ionic/storage';\n\n@IonicPage()\n@Component({\n  selector: 'page-profile',\n  templateUrl: 'profile.html'\n})\nexport class ProfilePage {\n\n  requestedUsername;\n  profileData;\n  isProfileMine;\n  isInfiniteScrollEnabled = true;\n  wallPosts = [];\n  profileViewMode = 'grid';\n  isLoggedIn = false;\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              public profileProvider: ProfileProvider,\n              public authHelperProvider: AuthHelperProvider,\n              public usersProvider: UsersProvider,\n              public viewCtrl: ViewController,\n              public toastCtrl: ToastController,\n              public postsProvider: PostsProvider,\n              public postProvider: PostProvider,\n              public storage: Storage,\n              public modalCtrl: ModalController,\n              public events: Events) {\n    this.isProfileMine = this.navParams.get('isProfileMine');\n    this.requestedUsername = this.navParams.get('username');\n    this.setup();\n  }\n\n  async setup() {\n    this.profileViewMode = await this.storage.get('profileViewMode') || 'grid';\n    this.isLoggedIn = await this.authHelperProvider.isLoggedIn();\n  }\n\n  ionViewWillEnter() {\n    this.getProfileInfo();\n    if (!this.isProfileMine) {\n      this.getInitialWallPosts();\n    }\n  }\n\n  dismiss() {\n    this.viewCtrl.dismiss();\n  }\n\n  ionViewDidLoad() {\n    if (this.isProfileMine) {\n      this.getInitialWallPosts();\n    }\n    this.listenForProfileChange();\n  }\n\n\n  getProfileInfo() {\n    this.authHelperProvider.getDecodedAuthToken().then((user) => {\n      this.profileProvider.getProfile(this.requestedUsername || user.username).subscribe((response) => {\n        this.profileData = response.data;\n        this.profileData.profilePicUrl = this.usersProvider.getProfilePicUrl(response.data._id);\n      }, (error) => {\n      });\n    });\n  }\n\n  onRefresh(refresher) {\n    this.getInitialWallPosts(refresher);\n    this.getProfileInfo();\n  }\n\n  getInitialWallPosts(refresher?) {\n    this.isInfiniteScrollEnabled = true;\n    let time = new Date().getTime();\n    this.authHelperProvider.getDecodedAuthToken().then((user) => {\n      this.postsProvider.getWallPosts(this.requestedUsername || user.username, time).subscribe((response) => {\n        if (refresher) {\n          refresher.complete();\n        }\n        this.wallPosts = response.data;\n      }, (error) => {\n        if (refresher) {\n          refresher.complete();\n        }\n        if (error.status === 404) {\n          return this.toastCtrl.create({\n            message: 'No posts available',\n            duration: 2000\n          }).present();\n        }\n        this.toastCtrl.create({\n          message: 'An error occured when getting posts',\n          duration: 2000\n        }).present();\n      });\n    });\n  }\n\n  async getPosts(infiniteScroll) {\n    let lastPostTime = new Date(this.wallPosts[this.wallPosts.length - 1].createdAt).getTime();\n    let user = await this.authHelperProvider.getDecodedAuthToken();\n    this.postsProvider.getWallPosts(this.requestedUsername || user.username, lastPostTime).subscribe((retrievedPictures) => {\n      const picData = retrievedPictures.data;\n      this.wallPosts.push(...picData);\n      infiniteScroll.complete();\n    }, (error) => {\n      infiniteScroll.complete();\n      this.isInfiniteScrollEnabled = false;\n      if (error.status === 404) {\n        return this.toastCtrl.create({\n          message: 'No more posts available',\n          duration: 2000\n        }).present();\n      }\n      this.toastCtrl.create({\n        message: 'An error occured when getting posts',\n        duration: 2000\n      }).present();\n    });\n  }\n\n  selectViewMode(mode: string) {\n    this.storage.set('profileViewMode', mode);\n    this.profileViewMode = mode;\n  }\n\n  followUser() {\n    this.usersProvider.followUser(this.profileData._id).subscribe((response) => {\n      this.profileData.isFollowed = true;\n      this.profileData.followeesCount += 1;\n    }, (error) => {\n      this.toastCtrl.create({ message: 'Error following user....', duration: 1500 }).present();\n    });\n  }\n\n  unFollowUser() {\n    this.usersProvider.unFollowUser(this.profileData._id).subscribe((response) => {\n      this.profileData.isFollowed = false;\n      this.profileData.followeesCount -= 1;\n    }, (error) => {\n      this.toastCtrl.create({ message: 'Error following user....', duration: 1500 }).present();\n    });\n  }\n\n  openSettingsModal() {\n    let modal = this.modalCtrl.create('SettingsPage');\n    modal.present();\n  }\n\n  listenForProfileChange() {\n    this.events.subscribe('profile:change', () => {\n      this.getProfileInfo();\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile.ts"],"sourceRoot":""}