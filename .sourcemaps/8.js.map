{"version":3,"sources":["../../src/pages/post-comments/post-comments.module.ts","../../src/pages/post-comments/post-comments.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PostCommentsPage } from './post-comments';\nimport { PipesModule } from '../../pipes/pipes.module';\nimport { ComponentsModule } from '../../components/components.module';\n\n@NgModule({\n  declarations: [\n    PostCommentsPage\n  ],\n  imports: [\n    PipesModule,\n    IonicPageModule.forChild(PostCommentsPage),\n    ComponentsModule\n  ]\n})\nexport class PostCommentsPageModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post-comments/post-comments.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { Content, IonicPage, Keyboard, NavController, NavParams, ToastController, ViewController } from 'ionic-angular';\nimport { PostProvider } from '../../providers/post/post';\nimport { Subscription } from 'rxjs/Subscription';\nimport { UsersProvider } from '../../providers/users/users';\nimport { AuthHelperProvider } from '../../providers/auth-helper/auth-helper';\nimport 'rxjs/add/operator/finally';\n\n@IonicPage()\n@Component({\n  selector: 'page-post-comments',\n  templateUrl: 'post-comments.html'\n})\nexport class PostCommentsPage {\n\n  post;\n  comments = [];\n  subscriptions: Subscription[] = [];\n  newComment = '';\n  isLoggedIn = false;\n  didLoad = false;\n  @ViewChild(Content) content: Content;\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              public viewCtrl: ViewController,\n              public postProvider: PostProvider,\n              public usersProvider: UsersProvider,\n              public authHelperProvider: AuthHelperProvider,\n              public toastCtrl: ToastController,\n              public keyboard: Keyboard) {\n    this.post = this.navParams.get('post');\n    this.authHelperProvider.isLoggedIn().then((isLogged) => {\n      this.isLoggedIn = isLogged;\n    });\n  }\n\n  dismiss() {\n    this.viewCtrl.dismiss();\n  }\n\n  openProfilePage(comment) {\n    this.navCtrl.push('ProfilePage', { username: comment.user.username });\n  }\n\n  ionViewDidLoad() {\n    this.loadComments();\n  }\n\n  ionViewDidLeave() {\n    this.subscriptions.forEach((sub) => {\n      sub.unsubscribe();\n    });\n  }\n\n  loadComments() {\n    this.subscriptions.push(this.postProvider.getComments(this.post._id)\n      .finally(() => {\n        this.didLoad = true;\n      }).subscribe((response) => {\n        this.comments = response.data;\n        this.comments.map((comment) => {\n          return comment.profilePicUrl = this.usersProvider.getProfilePicUrl(comment.user._id);\n        });\n        this.goToBottom();\n      }, (error) => {\n        console.log(error);\n        if (error.status === 404) {\n          return this.toastCtrl.create({ message: 'No comments available.', duration: 1500 }).present();\n        }\n        return this.toastCtrl.create({ message: 'Couldn\\'t load comments :/', duration: 1500 }).present();\n      }));\n  }\n\n  onCommentFormSubmit() {\n    const comment = this.newComment.trim();\n    const postId = this.post._id;\n    if (!comment.length) {\n      return null;\n    }\n    this.keyboard.close();\n    this.newComment = '';\n    this.subscriptions.push(this.postProvider.commentPost(postId, { comment }).subscribe((data) => {\n      this.authHelperProvider.getDecodedAuthToken().then((user) => {\n        const commentToAdd = {\n          user: user,\n          comment: comment,\n          profilePicUrl: this.usersProvider.getProfilePicUrl(user._id)\n        };\n        this.comments.push(commentToAdd);\n        this.goToBottom();\n        this.post.commentsCount += 1;\n      });\n    }, (error) => {\n      console.log(error);\n      return this.toastCtrl.create({ message: 'An error occured :/', duration: 1500 }).present();\n    }));\n  }\n\n  goToBottom() {\n    setTimeout(() => {\n      this.content.scrollToBottom();\n    }, 200);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post-comments/post-comments.ts"],"sourceRoot":""}